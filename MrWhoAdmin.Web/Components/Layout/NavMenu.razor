@using Microsoft.AspNetCore.Components.Authorization

<RadzenPanelMenu DisplayStyle="MenuItemDisplayStyle.IconAndText" Multiple="false" class="rz-background-color-base-100">
    
    <!-- Main Dashboard -->
    <RadzenPanelMenuItem Text="Dashboard" Icon="dashboard" Path="/" />
    
    <!-- Realm Management -->
    <RadzenPanelMenuItem Text="Realms" Icon="domain">
        <RadzenPanelMenuItem Text="All Realms" Icon="domain" Path="/realms" />
        <RadzenPanelMenuItem Text="Add Realm" Icon="add_circle" Path="/realms/add" />
    </RadzenPanelMenuItem>

    <!-- Client Management -->
    <RadzenPanelMenuItem Text="Clients" Icon="apps">
        <RadzenPanelMenuItem Text="All Clients" Icon="apps" Path="/clients" />
        <RadzenPanelMenuItem Text="Add Client" Icon="add_circle" Path="/clients/add" />
        <RadzenPanelMenuItem Text="Client Types" Icon="category" Path="/clients/types" />
    </RadzenPanelMenuItem>
    
    <!-- User Management -->
    <RadzenPanelMenuItem Text="Users" Icon="people">
        <RadzenPanelMenuItem Text="All Users" Icon="person" Path="/users" />
        <RadzenPanelMenuItem Text="Pending Registrations" Icon="how_to_reg" Path="/users/registrations" />
        <RadzenPanelMenuItem Text="Add User" Icon="person_add" Path="/users/add" />
        <RadzenPanelMenuItem Text="User Roles" Icon="security" Path="/users/roles" />
    </RadzenPanelMenuItem>
    
    <!-- Identity Server -->
    <RadzenPanelMenuItem Text="Identity Server" Icon="verified_user">
        <RadzenPanelMenuItem Text="Scopes" Icon="tune" Path="/identity/scopes" />
        <RadzenPanelMenuItem Text="API Resources" Icon="api" Path="/identity/api-resources" />
        <RadzenPanelMenuItem Text="Identity Resources" Icon="fingerprint" Path="/identity/identity-resources" />
        <RadzenPanelMenuItem Text="Identity Providers" Icon="account_tree" Path="/identity-providers" />
        <RadzenPanelMenuItem Text="Debug Tokens" Icon="bug_report" Path="/debug-tokens" />
        <RadzenPanelMenuItem Text="Debug Token Refresh" Icon="autorenew" Path="/debug-token-refresh" />
    </RadzenPanelMenuItem>
    
    <!-- Reports & Monitoring -->
    <RadzenPanelMenuItem Text="Monitoring" Icon="analytics">
        <RadzenPanelMenuItem Text="Active Sessions" Icon="people_outline" Path="/monitoring/sessions" />
        <RadzenPanelMenuItem Text="Token Statistics" Icon="bar_chart" Path="/monitoring/tokens" />
        <RadzenPanelMenuItem Text="API Usage" Icon="api" Path="/monitoring/api-usage" />
        <RadzenPanelMenuItem Text="Audit Log" Icon="history" Path="/monitoring/audit" />
    </RadzenPanelMenuItem>
    
    <!-- System Administration -->
    <RadzenPanelMenuItem Text="System" Icon="settings">
        <RadzenPanelMenuItem Text="Configuration" Icon="tune" Path="/system/config" />
        <RadzenPanelMenuItem Text="Health Check" Icon="health_and_safety" Path="/system/health" />
        <RadzenPanelMenuItem Text="Auth Diagnostics" Icon="bug_report" Path="/debug/auth-diagnostics" />
        <RadzenPanelMenuItem Text="Claims Debug" Icon="verified_user" Path="/debug/claims" />
    </RadzenPanelMenuItem>

</RadzenPanelMenu>

@code {
    [Inject] private NavigationManager Navigation { get; set; } = default!;
    [Inject] private NotificationService NotificationService { get; set; } = default!;

    private string GetUserDisplayName(System.Security.Claims.ClaimsPrincipal user)
    {
        return user.FindFirst("name")?.Value ??
               user.FindFirst("preferred_username")?.Value ??
               user.FindFirst("given_name")?.Value ??
               user.FindFirst("email")?.Value ??
               user.FindFirst("http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier")?.Value ??
               user.Identity?.Name ??
               "User";
    }

    private void NavigateToLogin()
    {
        Navigation.NavigateTo("/login");
    }

    protected override void OnInitialized()
    {
    }
}
