@inject ILogger<Routes> Logger

<CascadingAuthenticationState>
    <AppErrorBoundary>
        <Router AppAssembly="typeof(Program).Assembly">
            <Found Context="routeData">
                <AuthorizeRouteView RouteData="routeData" DefaultLayout="typeof(Layout.MainLayout)">
                    <NotAuthorized>
                        @if (context.User.Identity?.IsAuthenticated != true)
                        {
                            <RedirectToLogin />
                        }
                        else
                        {
                            <div class="container mt-4">
                                <RadzenCard>
                                    <RadzenAlert AlertStyle="AlertStyle.Warning">
                                        <RadzenText TextStyle="TextStyle.H5" Class="mb-2">Access Denied</RadzenText>
                                        <RadzenText TextStyle="TextStyle.Body1">
                                            You don't have permission to access this resource.
                                        </RadzenText>
                                    </RadzenAlert>
                                    <div class="mt-3">
                                        <RadzenButton Text="Go to Home" 
                                                    ButtonStyle="ButtonStyle.Primary"
                                                    Icon="home"
                                                    Click="@(() => NavigationManager.NavigateTo("/"))" />
                                    </div>
                                </RadzenCard>
                            </div>
                        }
                    </NotAuthorized>
                    <Authorizing>
                        <div class="container mt-4">
                            <RadzenCard>
                                <div class="text-center p-4">
                                    <RadzenIcon Icon="hourglass_empty" Style="font-size: 3rem; color: var(--rz-warning);" Class="mb-3" />
                                    <RadzenText TextStyle="TextStyle.H5" Class="mb-2">Checking Authentication</RadzenText>
                                    <RadzenText TextStyle="TextStyle.Body1">Please wait while we verify your access...</RadzenText>
                                    <RadzenProgressBar Value="100" ShowValue="false" Class="mt-3" />
                                </div>
                            </RadzenCard>
                        </div>
                    </Authorizing>
                </AuthorizeRouteView>
                <FocusOnNavigate RouteData="routeData" Selector="h1" />
            </Found>
            <NotFound>
                <PageTitle>Not found</PageTitle>
                <LayoutView Layout="typeof(Layout.MainLayout)">
                    <div class="container mt-4">
                        <RadzenCard>
                            <RadzenAlert AlertStyle="AlertStyle.Warning">
                                <RadzenText TextStyle="TextStyle.H5" Class="mb-2">Page Not Found</RadzenText>
                                <RadzenText TextStyle="TextStyle.Body1">
                                    Sorry, there's nothing at this address.
                                </RadzenText>
                            </RadzenAlert>
                            <div class="mt-3">
                                <RadzenButton Text="Go to Home" 
                                            ButtonStyle="ButtonStyle.Primary"
                                            Icon="home"
                                            Click="@(() => NavigationManager.NavigateTo("/"))" />
                            </div>
                        </RadzenCard>
                    </div>
                </LayoutView>
            </NotFound>
        </Router>
    </AppErrorBoundary>
</CascadingAuthenticationState>

@code {
    [Inject] private NavigationManager NavigationManager { get; set; } = default!;
    
    protected override void OnInitialized()
    {
        Logger.LogInformation("Routes component initialized with authentication cascading");
    }
}
